#!/bin/bash

input_file="template.drl"
output_file="generated_rules.drl"

# Safety check
if [[ ! -f "$input_file" ]]; then
  echo "❌ Template file '$input_file' not found."
  exit 1
fi

# Extract base rule name prefix (e.g., AB177_7711_)
base_name=$(grep -oP 'rule\s+"AB177_7711_\d{4}"' "$input_file" | head -1 | sed -E 's/rule\s+"(.*)_\d{4}"/\1/')

# Clear or create output file
echo "// Auto-generated DRL file" > "$output_file"

# Generate rules 0001 to 1000
for i in $(seq -f "%04g" 1 1000); do
  rule_name="${base_name}_$i"

  # Replace only the rule name line
  sed -e "s/rule \".*\"/rule \"$rule_name\"/" "$input_file" >> "$output_file"
  echo "" >> "$output_file"  # Add spacing
done

echo "✅ Generated $output_file with 1000 rules."
